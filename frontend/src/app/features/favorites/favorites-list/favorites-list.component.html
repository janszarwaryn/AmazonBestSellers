<div class="favorites-container">
  <p-toast></p-toast>
  <p-confirmDialog></p-confirmDialog>

  <div class="header">
    <h1>My Favorites</h1>
  </div>

  @if (errorMessage()) {
    <p-message severity="error" [text]="errorMessage()!" class="error-message"></p-message>
  }

  @if (loading()) {
    <div class="favorites-grid">
      @for (item of [1, 2, 3, 4]; track item) {
        <p-card class="favorite-card">
          <p-skeleton width="100%" height="200px"></p-skeleton>
          <p-skeleton width="100%" height="1.5rem" styleClass="mt-2"></p-skeleton>
          <p-skeleton width="80%" height="1rem" styleClass="mt-2"></p-skeleton>
          <p-skeleton width="60%" height="1rem" styleClass="mt-2"></p-skeleton>
        </p-card>
      }
    </div>
  } @else if (favorites().length === 0) {
    <div class="empty-state">
      <i class="pi pi-heart" style="font-size: 4rem;"></i>
      <h2>No favorites yet</h2>
      <p>Start adding products to your favorites from the bestsellers page!</p>
    </div>
  } @else {
    <div class="favorites-grid">
      @for (favorite of favorites(); track favorite.id) {
        <p-card class="favorite-card">
          <ng-template pTemplate="header">
            @if (favorite.imageUrl) {
              <img
                [src]="favorite.imageUrl"
                [alt]="favorite.title"
                class="product-image"
              />
            } @else {
              <div class="no-image">
                <i class="pi pi-image" style="font-size: 3rem;"></i>
              </div>
            }
          </ng-template>

          <div class="product-details">
            <h3 class="product-title">{{ favorite.title }}</h3>

            @if (favorite.price) {
              <div class="product-price">{{ favorite.price }}</div>
            }

            @if (favorite.rating) {
              <div class="product-rating">
                <i class="pi pi-star-fill"></i>
                <span>{{ favorite.rating }}</span>
              </div>
            }

            <div class="added-date">
              <i class="pi pi-calendar"></i>
              <span>Added {{ formatDate(favorite.createdAt) }}</span>
            </div>
          </div>

          <ng-template pTemplate="footer">
            <button
              pButton
              icon="pi pi-trash"
              label="Remove"
              class="p-button-danger w-full"
              (click)="confirmRemove(favorite)"
            ></button>
          </ng-template>
        </p-card>
      }
    </div>
  }
</div>
