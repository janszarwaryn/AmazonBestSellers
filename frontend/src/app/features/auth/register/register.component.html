<div class="auth-container">
  <p-card header="Register" class="auth-card">
    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
      @if (errorMessage()) {
        <p-message severity="error" [text]="errorMessage()!" class="error-message"></p-message>
      }

      <div class="form-field">
        <label for="username">Username</label>
        <input
          pInputText
          id="username"
          formControlName="username"
          placeholder="Enter your username"
          [class.ng-invalid]="username?.invalid && username?.touched"
        />
        @if (username?.invalid && username?.touched) {
          <small class="error-text">
            @if (username?.errors?.['required']) {
              Username is required
            }
            @if (username?.errors?.['minlength']) {
              Username must be at least 5 characters
            }
            @if (username?.errors?.['pattern']) {
              Username can only contain letters and numbers
            }
          </small>
        }
      </div>

      <div class="form-field">
        <label for="password">Password</label>
        <p-password
          formControlName="password"
          [feedback]="true"
          [toggleMask]="true"
          placeholder="Enter your password"
          [class.ng-invalid]="password?.invalid && password?.touched"
        ></p-password>
        @if (password?.invalid && password?.touched) {
          <small class="error-text">
            @if (password?.errors?.['required']) {
              Password is required
            }
            @if (password?.errors?.['minlength']) {
              Password must be at least 8 characters
            }
            @if (password?.errors?.['passwordComplexity']) {
              <div>Password must contain:</div>
              <ul>
                <li>At least one uppercase letter</li>
                <li>At least one lowercase letter</li>
                <li>At least one digit</li>
                <li>At least one special character</li>
              </ul>
            }
          </small>
        }
      </div>

      <div class="form-field">
        <label for="passwordConfirm">Confirm Password</label>
        <p-password
          formControlName="passwordConfirm"
          [feedback]="false"
          [toggleMask]="true"
          placeholder="Confirm your password"
          [class.ng-invalid]="passwordConfirm?.invalid && passwordConfirm?.touched"
        ></p-password>
        @if (passwordConfirm?.invalid && passwordConfirm?.touched) {
          <small class="error-text">
            @if (passwordConfirm?.errors?.['required']) {
              Please confirm your password
            }
            @if (passwordConfirm?.errors?.['passwordMismatch']) {
              Passwords do not match
            }
          </small>
        }
      </div>

      <button
        pButton
        type="submit"
        label="Register"
        class="submit-button"
        [loading]="loading()"
        [disabled]="loading()"
      ></button>

      <div class="link-container">
        <span>Already have an account? </span>
        <a routerLink="/login" class="link">Login here</a>
      </div>
    </form>
  </p-card>
</div>
